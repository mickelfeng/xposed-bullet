import java.nio.charset.StandardCharsets
import java.nio.file.Files
import java.nio.file.Paths
import java.security.SecureRandom

allprojects {
    ext {
        randomKeywords = {
            /**
             * 随机排序字典
             */
            def dicPath = Paths.get("$rootProject.projectDir/proguard/keywords.txt")
            def dic = Files.readAllLines(dicPath, StandardCharsets.UTF_8)
            def rand = new SecureRandom()
            def dicSize = dic.size()
            for (int i = 0; i < dicSize; i++) {
                def index1 = rand.nextInt(dicSize)
                def index2 = rand.nextInt(dicSize)

                String index1Str = dic.get(index1)
                dic.set(index1, dic.get(index2))
                dic.set(index2, index1Str)
            }
            Files.write(Paths.get("$rootProject.projectDir/proguard/keywords-random.txt"), dic, StandardCharsets.UTF_8)
        }
    }
}
